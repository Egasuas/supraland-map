<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Supraland - Six Inches Under</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-csv/1.0.21/jquery.csv.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
        crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
        integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
        crossorigin=""></script>
    <style>
        body { margin: 0; padding: 0; }
        #map { position: absolute; top: 0; bottom: 0; width: 100%; background: #141414; }
    </style>
</head>
<body>
<div id="map"></div>
<script>
    // Map configuration
    var map = L.map('map', {
        crs: L.CRS.Simple,
        minZoom: -3
    });
    var bounds = [[0, 0], [5500, 8192]];
    var image = L.imageOverlay('img/map.jpg', bounds).addTo(map);
    map.fitBounds(bounds);

    // Layer configuration
    var chestIcon = L.icon({
        iconUrl: 'img/chest.webp',
        iconSize: [48,48],
        iconAnchor: [24,24]
    });
    var coinIcon = L.icon({
        iconUrl: 'img/coin.webp',
        iconSize: [23.3, 29.3],
        iconAnchor: [12, 13.3]
    });
    var chestLayer = L.layerGroup().addTo(map);
    var coinLayer = L.layerGroup().addTo(map);
    var coordinateLayer = L.layerGroup();
    L.control.layers({}, {Chests: chestLayer, Coins: coinLayer, XY: coordinateLayer}, {collapsed: false}).addTo(map);

    // Chest definitions - ToDo extract from csv
    L.marker([1399, 5156], {icon: chestIcon, title: 'Hello world!'})
        .bindPopup('Hello world!')
        .addTo(chestLayer);
    L.marker([1741, 3172], {icon: chestIcon, title: 'Foo Bar'})
        .bindPopup('Foo Bar')
        .addTo(chestLayer);

    // Coin definitions - ToDo extract from csv
    L.marker([42, 1337], {icon: coinIcon, title: '13 Coins'})
        .bindPopup('13 Coins')
        .addTo(coinLayer);

    // Coordinate extraction tool
    L.marker([2750, 4096], {zIndexOffset: 1000, draggable: true})
        .bindPopup('-, -')
        .addTo(coordinateLayer)
        .on('moveend', function(e) {
            var marker = e.target;
            var latlng = marker.getLatLng();
            var x = Math.round(latlng.lng), y = Math.round(5500 - latlng.lat);
            marker.setPopupContent(x + ', ' + y);
            marker.openPopup();
        });
</script>
</body>
</html>